module load  python/miniforge3_pytorch/2.5.0
module load cuda/12.3

# Allows system modules to be visible from venv environment
python -m venv --system-site-packages galformer

source galformer/bin/activate

# Allows Jupyter to recognize the environment as a kernel.
# pip install ipykernel

salloc --mem=16g --nodes=1 --ntasks-per-node=1 --cpus-per-task=8   --partition=ghx4   --account=bekw-dtai-gh --time=00:30:00 --gpus-per-node=1

srun nvidia-smi

srun --unbuffered python Galformer_pytorch.py